{
  "openapi": "3.0.3",
  "info": {
    "title": "Sparklio Agent API",
    "version": "2.0.0",
    "description": "Sparklio AI Marketing Studio - Agent API 명세서\n\n6개 전문 Agent를 REST API로 제공하여 마케팅 콘텐츠 생성, 전략 수립, 디자인, 리뷰, 최적화, 편집 작업 수행\n\n## 사용 가능한 Agent\n- **copywriter**: 텍스트 콘텐츠 생성\n- **strategist**: 마케팅 전략 수립\n- **designer**: 비주얼 콘텐츠 생성\n- **reviewer**: 콘텐츠 품질 검토\n- **optimizer**: 콘텐츠 최적화\n- **editor**: 콘텐츠 편집/교정",
    "contact": {
      "name": "B팀 Backend",
      "email": "backend@sparklio.ai"
    },
    "license": {
      "name": "Proprietary"
    }
  },
  "servers": [
    {
      "url": "http://100.123.51.5:8000/api/v1",
      "description": "맥미니 M2 개발 서버 (Tailscale VPN)"
    },
    {
      "url": "http://localhost:8000/api/v1",
      "description": "로컬 개발 서버"
    }
  ],
  "tags": [
    {
      "name": "Agents",
      "description": "Agent 실행 및 관리"
    },
    {
      "name": "Agent Info",
      "description": "Agent 정보 조회"
    }
  ],
  "paths": {
    "/agents/list": {
      "get": {
        "tags": ["Agent Info"],
        "summary": "사용 가능한 Agent 목록 조회",
        "description": "전체 Agent 목록과 각 Agent가 지원하는 작업(task) 목록 반환",
        "operationId": "listAgents",
        "responses": {
          "200": {
            "description": "Agent 목록 조회 성공",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AgentListResponse"
                },
                "example": {
                  "agents": [
                    {
                      "name": "copywriter",
                      "description": "텍스트 콘텐츠 생성 (제품 설명, SNS, 광고 카피 등)",
                      "tasks": ["product_detail", "sns", "brand_message", "headline", "ad_copy"]
                    },
                    {
                      "name": "strategist",
                      "description": "마케팅 전략 수립 (브랜드 전략, 캠페인 기획 등)",
                      "tasks": ["brand_kit", "campaign", "target_analysis", "positioning", "content_strategy"]
                    },
                    {
                      "name": "designer",
                      "description": "비주얼 콘텐츠 생성 (제품 이미지, 로고, 썸네일 등)",
                      "tasks": ["product_image", "brand_logo", "sns_thumbnail", "ad_banner", "illustration"]
                    },
                    {
                      "name": "reviewer",
                      "description": "콘텐츠 품질 검토 (품질 평가, 피드백 제공)",
                      "tasks": ["content_review", "copy_review", "brand_consistency", "grammar_check", "effectiveness_analysis"]
                    },
                    {
                      "name": "optimizer",
                      "description": "콘텐츠 최적화 (SEO, 전환율, 가독성 개선)",
                      "tasks": ["seo_optimize", "conversion_optimize", "readability_improve", "length_adjust", "tone_adjust"]
                    },
                    {
                      "name": "editor",
                      "description": "콘텐츠 편집/교정 (교정, 재작성, 요약, 번역)",
                      "tasks": ["proofread", "rewrite", "summarize", "expand", "translate"]
                    }
                  ]
                }
              }
            }
          }
        }
      }
    },
    "/agents/{agent_name}/info": {
      "get": {
        "tags": ["Agent Info"],
        "summary": "특정 Agent 정보 조회",
        "description": "Agent의 이름, 설명, 지원 작업 목록, 예제 요청 반환",
        "operationId": "getAgentInfo",
        "parameters": [
          {
            "name": "agent_name",
            "in": "path",
            "required": true,
            "description": "Agent 이름",
            "schema": {
              "type": "string",
              "enum": ["copywriter", "strategist", "designer", "reviewer", "optimizer", "editor"]
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Agent 정보 조회 성공",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AgentInfo"
                }
              }
            }
          },
          "404": {
            "description": "Agent를 찾을 수 없음",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                },
                "example": {
                  "detail": "Agent 'unknown_agent' not found"
                }
              }
            }
          }
        }
      }
    },
    "/agents/{agent_name}/execute": {
      "post": {
        "tags": ["Agents"],
        "summary": "Agent 실행",
        "description": "특정 Agent를 실행하여 작업 수행. \n\n**실행 흐름**:\n1. `task` 유형 지정 (예: product_detail, sns, brand_message)\n2. `payload`에 작업 입력 데이터 전달\n3. `options`로 추가 옵션 지정 (tone, length, style 등)\n4. Agent가 작업 수행 후 결과 반환\n\n**응답 시간**: 15-30초 (LLM Live 모드), 1-2초 (Mock 모드)",
        "operationId": "executeAgent",
        "parameters": [
          {
            "name": "agent_name",
            "in": "path",
            "required": true,
            "description": "실행할 Agent 이름",
            "schema": {
              "type": "string",
              "enum": ["copywriter", "strategist", "designer", "reviewer", "optimizer", "editor"]
            }
          }
        ],
        "requestBody": {
          "required": true,
          "description": "Agent 실행 요청 데이터",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/AgentExecuteRequest"
              },
              "examples": {
                "copywriter_product_detail": {
                  "summary": "Copywriter - 제품 설명 생성",
                  "value": {
                    "task": "product_detail",
                    "payload": {
                      "product_name": "무선 이어폰",
                      "features": ["노이즈캔슬링", "24시간 배터리", "IPX7 방수"],
                      "target_audience": "2030 직장인"
                    },
                    "options": {
                      "tone": "professional",
                      "length": "medium"
                    }
                  }
                },
                "strategist_brand_kit": {
                  "summary": "Strategist - 브랜드 전략 수립",
                  "value": {
                    "task": "brand_kit",
                    "payload": {
                      "brand_name": "EcoLife",
                      "industry": "친환경 생활용품",
                      "target_market": "환경 의식이 높은 2030 세대"
                    },
                    "options": {
                      "depth": "comprehensive"
                    }
                  }
                },
                "reviewer_content_review": {
                  "summary": "Reviewer - 콘텐츠 검토",
                  "value": {
                    "task": "content_review",
                    "payload": {
                      "content": "이 제품은 최고입니다. 정말 좋아요!",
                      "brand_guidelines": {
                        "tone": "professional",
                        "avoid_words": ["최고", "정말"]
                      }
                    },
                    "options": {
                      "strict_mode": true
                    }
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Agent 실행 성공",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AgentResponse"
                },
                "examples": {
                  "copywriter_success": {
                    "summary": "Copywriter 성공 응답",
                    "value": {
                      "outputs": {
                        "headline": "프리미엄 노이즈캔슬링, 24시간 자유로운 음악 경험",
                        "body": "2030 직장인을 위한 최적의 선택. IPX7 방수로 어디서나 안심하고 사용하세요.",
                        "bullets": [
                          "업계 최고 수준 노이즈캔슬링",
                          "24시간 장시간 배터리",
                          "IPX7 완전 방수"
                        ]
                      },
                      "usage": {
                        "tokens": 1605,
                        "elapsed_seconds": 16.03
                      },
                      "meta": {
                        "agent": "copywriter",
                        "task": "product_detail",
                        "model_used": "qwen2.5:7b"
                      }
                    }
                  },
                  "strategist_success": {
                    "summary": "Strategist 성공 응답",
                    "value": {
                      "outputs": {
                        "positioning": "친환경 생활을 실천하는 MZ세대의 첫 번째 선택",
                        "key_messages": [
                          "지속 가능한 소비",
                          "스타일과 환경의 조화",
                          "일상 속 작은 변화"
                        ],
                        "channels": ["Instagram", "YouTube", "친환경 커뮤니티"],
                        "content_strategy": {
                          "themes": ["제로웨이스트 챌린지", "에코 라이프 팁", "제품 사용 후기"]
                        }
                      },
                      "usage": {
                        "tokens": 2200,
                        "elapsed_seconds": 22.5
                      },
                      "meta": {
                        "agent": "strategist",
                        "task": "brand_kit",
                        "model_used": "qwen2.5:14b"
                      }
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "잘못된 요청 (필수 필드 누락, 유효하지 않은 task 등)",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                },
                "example": {
                  "detail": "Agent execution failed: Invalid task 'unknown_task' for copywriter agent"
                }
              }
            }
          },
          "404": {
            "description": "Agent를 찾을 수 없음",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                },
                "example": {
                  "detail": "Agent 'unknown_agent' not found"
                }
              }
            }
          },
          "500": {
            "description": "서버 내부 오류 (LLM 연결 실패, 타임아웃 등)",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                },
                "example": {
                  "detail": "Internal server error: Ollama connection timeout"
                }
              }
            }
          }
        }
      }
    }
  },
  "components": {
    "schemas": {
      "AgentExecuteRequest": {
        "type": "object",
        "required": ["task", "payload"],
        "properties": {
          "task": {
            "type": "string",
            "description": "작업 유형 (Agent별로 지원하는 task가 다름)",
            "example": "product_detail"
          },
          "payload": {
            "type": "object",
            "description": "작업 입력 데이터 (task에 따라 구조가 다름)",
            "additionalProperties": true,
            "example": {
              "product_name": "무선 이어폰",
              "features": ["노이즈캔슬링", "24시간 배터리"],
              "target_audience": "2030 직장인"
            }
          },
          "options": {
            "type": "object",
            "description": "추가 옵션 (tone, length, style 등)",
            "additionalProperties": true,
            "example": {
              "tone": "professional",
              "length": "medium"
            }
          }
        }
      },
      "AgentResponse": {
        "type": "object",
        "required": ["outputs", "usage", "meta"],
        "properties": {
          "outputs": {
            "type": "object",
            "description": "Agent 실행 결과 (task에 따라 구조가 다름)",
            "additionalProperties": true,
            "example": {
              "headline": "프리미엄 노이즈캔슬링",
              "body": "2030 직장인을 위한 최적의 선택",
              "bullets": ["노이즈캔슬링", "24시간 배터리", "IPX7 방수"]
            }
          },
          "usage": {
            "type": "object",
            "description": "리소스 사용량",
            "properties": {
              "tokens": {
                "type": "integer",
                "description": "사용된 토큰 수",
                "example": 1605
              },
              "elapsed_seconds": {
                "type": "number",
                "format": "float",
                "description": "실행 시간 (초)",
                "example": 16.03
              }
            }
          },
          "meta": {
            "type": "object",
            "description": "메타데이터",
            "properties": {
              "agent": {
                "type": "string",
                "description": "실행된 Agent 이름",
                "example": "copywriter"
              },
              "task": {
                "type": "string",
                "description": "실행된 작업 유형",
                "example": "product_detail"
              },
              "model_used": {
                "type": "string",
                "description": "사용된 LLM 모델",
                "example": "qwen2.5:7b"
              }
            }
          }
        }
      },
      "AgentListResponse": {
        "type": "object",
        "required": ["agents"],
        "properties": {
          "agents": {
            "type": "array",
            "description": "Agent 목록",
            "items": {
              "$ref": "#/components/schemas/AgentInfo"
            }
          }
        }
      },
      "AgentInfo": {
        "type": "object",
        "required": ["name", "description", "tasks"],
        "properties": {
          "name": {
            "type": "string",
            "description": "Agent 이름",
            "enum": ["copywriter", "strategist", "designer", "reviewer", "optimizer", "editor"],
            "example": "copywriter"
          },
          "description": {
            "type": "string",
            "description": "Agent 설명",
            "example": "텍스트 콘텐츠 생성 (제품 설명, SNS, 광고 카피 등)"
          },
          "tasks": {
            "type": "array",
            "description": "지원하는 작업 목록",
            "items": {
              "type": "string"
            },
            "example": ["product_detail", "sns", "brand_message", "headline", "ad_copy"]
          }
        }
      },
      "Error": {
        "type": "object",
        "required": ["detail"],
        "properties": {
          "detail": {
            "type": "string",
            "description": "에러 메시지",
            "example": "Agent 'unknown_agent' not found"
          }
        }
      }
    }
  }
}
