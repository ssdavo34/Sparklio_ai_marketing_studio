# í¬íŠ¸ í• ë‹¹ ê°€ì´ë“œ

**í”„ë¡œì íŠ¸**: Sparklio AI Marketing Studio
**ëª©ì **: 3-Node í™˜ê²½ì—ì„œ A/B/C íŒ€ ë™ì‹œ ì‘ì—… ì‹œ í¬íŠ¸ ì¶©ëŒ ë°©ì§€
**ì—…ë°ì´íŠ¸**: 2025-11-15

---

## ëª©ì°¨

1. [í¬íŠ¸ í• ë‹¹ ì „ëµ](#1-í¬íŠ¸-í• ë‹¹-ì „ëµ)
2. [í¬íŠ¸ í• ë‹¹ í‘œ](#2-í¬íŠ¸-í• ë‹¹-í‘œ)
3. [íŒ€ë³„ í¬íŠ¸ ì‚¬ìš© ê·œì¹™](#3-íŒ€ë³„-í¬íŠ¸-ì‚¬ìš©-ê·œì¹™)
4. [í¬íŠ¸ ì¶©ëŒ ë°©ì§€ ì²´í¬ë¦¬ìŠ¤íŠ¸](#4-í¬íŠ¸-ì¶©ëŒ-ë°©ì§€-ì²´í¬ë¦¬ìŠ¤íŠ¸)
5. [í¬íŠ¸ ë³€ê²½ í”„ë¡œí† ì½œ](#5-í¬íŠ¸-ë³€ê²½-í”„ë¡œí† ì½œ)
6. [ë¬¸ì œ í•´ê²°](#6-ë¬¸ì œ-í•´ê²°)

---

## 1. í¬íŠ¸ í• ë‹¹ ì „ëµ

### ì„¤ê³„ ì›ì¹™

**ì›ì¹™ 1: íŒ€ë³„ í¬íŠ¸ ë²”ìœ„ ë¶„ë¦¬**
- **ê³µí†µ ì¸í”„ë¼** (AíŒ€ ê´€ë¦¬): 5000-9999 (ê³ ì •)
- **Backend ê°œë°œ** (BíŒ€): 8000-8099
- **Frontend ê°œë°œ** (CíŒ€): 3000-3099
- **AI ì›Œì»¤** (AíŒ€): 11000-11999

**ì›ì¹™ 2: í™˜ê²½ë³„ í¬íŠ¸ êµ¬ë¶„**
- **ê°œë°œ í™˜ê²½**: ê¸°ë³¸ í¬íŠ¸ (ì˜ˆ: 8000)
- **í…ŒìŠ¤íŠ¸ í™˜ê²½**: +1 í¬íŠ¸ (ì˜ˆ: 8001)
- **ìŠ¤í…Œì´ì§• í™˜ê²½**: +10 í¬íŠ¸ (ì˜ˆ: 8010)

**ì›ì¹™ 3: ê³µí†µ ì„œë¹„ìŠ¤ í¬íŠ¸ ê³ ì •**
- PostgreSQL, Redis, MinIO ë“± ê³µí†µ ì¸í”„ë¼ëŠ” **ì ˆëŒ€ ë³€ê²½ ê¸ˆì§€**
- ëª¨ë“  íŒ€ì´ ì˜ì¡´í•˜ëŠ” ì„œë¹„ìŠ¤ì´ë¯€ë¡œ ì•ˆì •ì„± ìµœìš°ì„ 

**ì›ì¹™ 4: ìƒˆë¡œìš´ ì„œë¹„ìŠ¤ ì¶”ê°€ ì‹œ ì‚¬ì „ í˜‘ì˜**
- í¬íŠ¸ í• ë‹¹í‘œì— ë“±ë¡ í›„ ì‚¬ìš©
- GitHub Issue ë˜ëŠ” íŒ€ íšŒì˜ì—ì„œ ìŠ¹ì¸

---

## 2. í¬íŠ¸ í• ë‹¹ í‘œ

### 2.1 ê³µí†µ ì¸í”„ë¼ (AíŒ€ ê´€ë¦¬)

| ì„œë¹„ìŠ¤ | í¬íŠ¸ | í”„ë¡œí† ì½œ | ë…¸ë“œ | ì ‘ê·¼ ë²”ìœ„ | ìƒíƒœ | ë¹„ê³  |
|--------|------|----------|------|-----------|------|------|
| **PostgreSQL** | 5432 | TCP | Mac mini (100.123.51.5) | ëª¨ë“  ë…¸ë“œ | âœ… Running | ë°ì´í„°ë² ì´ìŠ¤ |
| **Redis** | 6379 | TCP | Mac mini (100.123.51.5) | ëª¨ë“  ë…¸ë“œ | âœ… Running | ìºì‹œ/ì„¸ì…˜ |
| **MinIO API** | 9000 | HTTP | Mac mini (100.123.51.5) | Backend ì „ìš© | âœ… Running | Object Storage API |
| **MinIO Console** | 9001 | HTTP | Mac mini (100.123.51.5) | ê°œë°œì (ë¸Œë¼ìš°ì €) | âœ… Running | ì›¹ UI |

**ì ‘ê·¼ ì˜ˆì‹œ**:
```bash
# PostgreSQL ì—°ê²° (ëª¨ë“  íŒ€)
psql -h 100.123.51.5 -p 5432 -U sparklio -d sparklio

# Redis ì—°ê²° (ëª¨ë“  íŒ€)
redis-cli -h 100.123.51.5 -p 6379

# MinIO Python SDK (BíŒ€)
from minio import Minio
client = Minio("100.123.51.5:9000", access_key="sparklio", secret_key="...", secure=False)

# MinIO Console (ë¸Œë¼ìš°ì €)
http://100.123.51.5:9001
```

---

### 2.2 AI ì›Œì»¤ (AíŒ€ ê´€ë¦¬)

| ì„œë¹„ìŠ¤ | í¬íŠ¸ | í”„ë¡œí† ì½œ | ë…¸ë“œ | ì ‘ê·¼ ë²”ìœ„ | ìƒíƒœ | ë¹„ê³  |
|--------|------|----------|------|-----------|------|------|
| **Ollama** | 11434 | HTTP | Desktop (100.120.180.42) | Backend ì „ìš© | â¸ï¸ Stopped | LLM ì¶”ë¡  ì„œë²„ |
| **ComfyUI** | 8188 | HTTP | Desktop (100.120.180.42) | Backend ì „ìš© | â¸ï¸ Stopped | ì´ë¯¸ì§€/ë¹„ë””ì˜¤ ìƒì„± |

**ì ‘ê·¼ ì˜ˆì‹œ**:
```python
# BíŒ€: Ollama API í˜¸ì¶œ
import requests
response = requests.post(
    "http://100.120.180.42:11434/api/generate",
    json={"model": "qwen2.5:7b", "prompt": "Write a product description"}
)

# BíŒ€: ComfyUI ì›Œí¬í”Œë¡œìš° ì‹¤í–‰
response = requests.post(
    "http://100.120.180.42:8188/prompt",
    json={"workflow": {...}}
)
```

**ì‹œì‘ ë°©ë²•** (Desktop):
```bash
# Ollama ì‹œì‘
docker start ollama

# ComfyUI ì‹œì‘
cd /d/AI/ComfyUI
./python_embeded/python.exe main.py --listen 0.0.0.0 --port 8188
```

---

### 2.3 Backend ê°œë°œ (BíŒ€)

| ì„œë¹„ìŠ¤ | í¬íŠ¸ | í”„ë¡œí† ì½œ | ë…¸ë“œ | ì ‘ê·¼ ë²”ìœ„ | ìƒíƒœ | ë¹„ê³  |
|--------|------|----------|------|-----------|------|------|
| **FastAPI (dev)** | 8000 | HTTP | Mac mini (100.123.51.5) | ëª¨ë“  ë…¸ë“œ | ğŸ”§ ê°œë°œ ì¤‘ | ë©”ì¸ ê°œë°œ ì„œë²„ |
| **FastAPI (test)** | 8001 | HTTP | Mac mini (100.123.51.5) | í…ŒìŠ¤íŠ¸ ì „ìš© | ğŸ“ ì˜ˆì•½ë¨ | (ì„ íƒ) í†µí•© í…ŒìŠ¤íŠ¸ìš© |
| **FastAPI (stage)** | 8010 | HTTP | Mac mini (100.123.51.5) | ìŠ¤í…Œì´ì§• ì „ìš© | ğŸ“ ì˜ˆì•½ë¨ | (í–¥í›„) ìŠ¤í…Œì´ì§• ë°°í¬ |

**ì ‘ê·¼ ì˜ˆì‹œ**:
```bash
# CíŒ€: Frontendì—ì„œ API í˜¸ì¶œ
fetch('http://100.123.51.5:8000/api/assets')

# BíŒ€: API ë¬¸ì„œ í™•ì¸
http://100.123.51.5:8000/docs

# í…ŒìŠ¤íŠ¸ ì„œë²„ (BíŒ€)
uvicorn app.main:app --host 0.0.0.0 --port 8001
```

**í¬íŠ¸ êµ¬ë¶„ ì‚¬ìš© ì‹œë‚˜ë¦¬ì˜¤**:
```bash
# ì‹œë‚˜ë¦¬ì˜¤ 1: ê°œë°œ ì¤‘ í†µí•© í…ŒìŠ¤íŠ¸
# í„°ë¯¸ë„ 1 (ê°œë°œ ì„œë²„)
uvicorn app.main:app --host 0.0.0.0 --port 8000 --reload

# í„°ë¯¸ë„ 2 (í…ŒìŠ¤íŠ¸ ì„œë²„ - í…ŒìŠ¤íŠ¸ DB ì‚¬ìš©)
export DATABASE_URL=postgresql://sparklio:pass@localhost/sparklio_test
uvicorn app.main:app --host 0.0.0.0 --port 8001

# ì‹œë‚˜ë¦¬ì˜¤ 2: ë²„ì „ë³„ ë™ì‹œ ì‹¤í–‰ (ë“œë¬¼ê²Œ ì‚¬ìš©)
# í„°ë¯¸ë„ 1 (ê¸°ì¡´ ë²„ì „)
git checkout v1.0
uvicorn app.main:app --port 8000

# í„°ë¯¸ë„ 2 (ìƒˆ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸)
git checkout feature/b-new-api
uvicorn app.main:app --port 8001
```

---

### 2.4 Frontend ê°œë°œ (CíŒ€)

| ì„œë¹„ìŠ¤ | í¬íŠ¸ | í”„ë¡œí† ì½œ | ë…¸ë“œ | ì ‘ê·¼ ë²”ìœ„ | ìƒíƒœ | ë¹„ê³  |
|--------|------|----------|------|-----------|------|------|
| **Next.js (dev)** | 3000 | HTTP | Laptop (100.101.68.23) | ê°œë°œì (ë¸Œë¼ìš°ì €) | ğŸ”§ ê°œë°œ ì¤‘ | ë©”ì¸ ê°œë°œ ì„œë²„ |
| **Next.js (preview)** | 3001 | HTTP | Laptop (100.101.68.23) | í”„ë¦¬ë·° ì „ìš© | ğŸ“ ì˜ˆì•½ë¨ | (ì„ íƒ) í”„ë¡œë•ì…˜ ë¹Œë“œ í…ŒìŠ¤íŠ¸ |

**ì ‘ê·¼ ì˜ˆì‹œ**:
```bash
# CíŒ€: ê°œë°œ ì„œë²„
cd ~/sparklio_ai_marketing_studio/frontend
npm run dev
# ë¸Œë¼ìš°ì €: http://localhost:3000

# Tailscale ë„¤íŠ¸ì›Œí¬ì—ì„œ ì ‘ê·¼ (ë‹¤ë¥¸ ë…¸ë“œ)
# http://100.101.68.23:3000

# í”„ë¡œë•ì…˜ ë¹Œë“œ í…ŒìŠ¤íŠ¸ (í¬íŠ¸ 3001)
npm run build
npm start -- -p 3001
```

---

### 2.5 ì˜ˆì•½ëœ í¬íŠ¸ (í–¥í›„ ì‚¬ìš©)

| ì„œë¹„ìŠ¤ | í¬íŠ¸ | ì˜ˆìƒ ìš©ë„ | ìš°ì„ ìˆœìœ„ |
|--------|------|----------|----------|
| **Celery Flower** | 5555 | ë¹„ë™ê¸° ì‘ì—… ëª¨ë‹ˆí„°ë§ | Medium |
| **Grafana** | 3100 | ì‹œìŠ¤í…œ ëª¨ë‹ˆí„°ë§ ëŒ€ì‹œë³´ë“œ | Low |
| **Prometheus** | 9090 | ë©”íŠ¸ë¦­ ìˆ˜ì§‘ | Low |
| **pgAdmin** | 5050 | PostgreSQL ê´€ë¦¬ UI | Low |

---

## 3. íŒ€ë³„ í¬íŠ¸ ì‚¬ìš© ê·œì¹™

### AíŒ€ (ì¸í”„ë¼)

**ì‚¬ìš© ê°€ëŠ¥ í¬íŠ¸**:
- 5000-5999: ë°ì´í„°ë² ì´ìŠ¤ ê´€ë ¨
- 6000-6999: ìºì‹œ/ë©”ì‹œì§•
- 9000-9999: Object Storage, ëª¨ë‹ˆí„°ë§
- 11000-11999: AI ì›Œì»¤

**ê·œì¹™**:
- âœ… **í—ˆìš©**: ìƒˆë¡œìš´ ì¸í”„ë¼ ì„œë¹„ìŠ¤ ì¶”ê°€ (ì˜ˆ: Kafka, Elasticsearch)
- âŒ **ê¸ˆì§€**: ê¸°ì¡´ ì„œë¹„ìŠ¤ í¬íŠ¸ ë³€ê²½ (PostgreSQL, Redis, MinIO)
- âš ï¸ **ì£¼ì˜**: í¬íŠ¸ ë³€ê²½ ì‹œ BíŒ€, CíŒ€ì— ì‚¬ì „ ê³µì§€

**ì¶”ê°€ ì„œë¹„ìŠ¤ ì˜ˆì‹œ**:
```bash
# ì˜ˆ: Elasticsearch ì¶”ê°€ (í¬íŠ¸ 9200)
# 1. PORT_ALLOCATION.md ì—…ë°ì´íŠ¸
# 2. GitHub Issueë¡œ BíŒ€, CíŒ€ì— ê³µì§€
# 3. docker-compose.ymlì— ì¶”ê°€

elasticsearch:
  image: elasticsearch:8.11
  ports:
    - "9200:9200"
```

---

### BíŒ€ (Backend)

**ì‚¬ìš© ê°€ëŠ¥ í¬íŠ¸**:
- 8000-8099: FastAPI ë° ê´€ë ¨ ì„œë¹„ìŠ¤

**ê·œì¹™**:
- âœ… **í—ˆìš©**: 8000 (ë©”ì¸), 8001 (í…ŒìŠ¤íŠ¸), 8010 (ìŠ¤í…Œì´ì§•)
- âŒ **ê¸ˆì§€**: 8000ë²ˆ í¬íŠ¸ë¥¼ ë‹¤ë¥¸ ìš©ë„ë¡œ ì‚¬ìš©
- âš ï¸ **ì£¼ì˜**: ìƒˆë¡œìš´ Backend ì„œë¹„ìŠ¤ ì¶”ê°€ ì‹œ 8002-8099 ë²”ìœ„ ì‚¬ìš©

**ì˜¬ë°”ë¥¸ ì‚¬ìš© ì˜ˆì‹œ**:
```bash
# âœ… ì¢‹ì€ ì˜ˆ: í• ë‹¹ëœ í¬íŠ¸ ì‚¬ìš©
uvicorn app.main:app --port 8000

# âœ… ì¢‹ì€ ì˜ˆ: í…ŒìŠ¤íŠ¸ìš© í¬íŠ¸
pytest --backend-url=http://localhost:8001

# âŒ ë‚˜ìœ ì˜ˆ: CíŒ€ í¬íŠ¸ ì‚¬ìš© (ì¶©ëŒ!)
uvicorn app.main:app --port 3000

# âŒ ë‚˜ìœ ì˜ˆ: ì„ì˜ í¬íŠ¸ ì‚¬ìš©
uvicorn app.main:app --port 5000  # PostgreSQLê³¼ ì¶©ëŒ ê°€ëŠ¥
```

---

### CíŒ€ (Frontend)

**ì‚¬ìš© ê°€ëŠ¥ í¬íŠ¸**:
- 3000-3099: Next.js ë° ê´€ë ¨ ì„œë¹„ìŠ¤

**ê·œì¹™**:
- âœ… **í—ˆìš©**: 3000 (ë©”ì¸), 3001 (í”„ë¦¬ë·°)
- âŒ **ê¸ˆì§€**: 3000ë²ˆ í¬íŠ¸ë¥¼ ë‹¤ë¥¸ ìš©ë„ë¡œ ì‚¬ìš©
- âš ï¸ **ì£¼ì˜**: Storybook ë“± ì¶”ê°€ ë„êµ¬ëŠ” 3002-3099 ì‚¬ìš©

**ì˜¬ë°”ë¥¸ ì‚¬ìš© ì˜ˆì‹œ**:
```bash
# âœ… ì¢‹ì€ ì˜ˆ: í• ë‹¹ëœ í¬íŠ¸ ì‚¬ìš©
npm run dev  # ê¸°ë³¸ í¬íŠ¸ 3000

# âœ… ì¢‹ì€ ì˜ˆ: Storybook ì¶”ê°€ (í¬íŠ¸ 3002)
npx storybook dev -p 3002

# âŒ ë‚˜ìœ ì˜ˆ: BíŒ€ í¬íŠ¸ ì‚¬ìš© (ì¶©ëŒ!)
npm run dev -- -p 8000

# âŒ ë‚˜ìœ ì˜ˆ: ì„ì˜ í¬íŠ¸ ì‚¬ìš©
npm run dev -- -p 4000  # ë¬¸ì„œí™”ë˜ì§€ ì•Šì€ í¬íŠ¸
```

---

## 4. í¬íŠ¸ ì¶©ëŒ ë°©ì§€ ì²´í¬ë¦¬ìŠ¤íŠ¸

### ìƒˆë¡œìš´ ì„œë¹„ìŠ¤ ì‹œì‘ ì „

- [ ] **í¬íŠ¸ í• ë‹¹í‘œ í™•ì¸**: ì‚¬ìš©í•˜ë ¤ëŠ” í¬íŠ¸ê°€ ì´ë¯¸ í• ë‹¹ë˜ì—ˆëŠ”ì§€ í™•ì¸
- [ ] **í¬íŠ¸ ì ìœ  í™•ì¸**: ì‹¤ì œë¡œ í¬íŠ¸ê°€ ì‚¬ìš© ì¤‘ì¸ì§€ í…ŒìŠ¤íŠ¸
- [ ] **íŒ€ ë²”ìœ„ ì¤€ìˆ˜**: ìì‹ ì˜ íŒ€ì— í• ë‹¹ëœ í¬íŠ¸ ë²”ìœ„ ë‚´ì—ì„œ ì„ íƒ
- [ ] **í™˜ê²½ ë³€ìˆ˜ ì„¤ì •**: `.env` íŒŒì¼ì— í¬íŠ¸ ë²ˆí˜¸ ëª…ì‹œ

### í¬íŠ¸ ì ìœ  í™•ì¸ ë°©ë²•

**Mac mini / Laptop (Unix)**:
```bash
# ë°©ë²• 1: lsof (ê¶Œì¥)
lsof -i :8000

# ë°©ë²• 2: netstat
netstat -an | grep 8000

# ë°©ë²• 3: telnet (í¬íŠ¸ ì—´ë¦¼ ì—¬ë¶€ë§Œ í™•ì¸)
telnet 100.123.51.5 8000
```

**Desktop (Windows)**:
```powershell
# ë°©ë²• 1: netstat
netstat -ano | findstr :8000

# ë°©ë²• 2: Test-NetConnection (PowerShell)
Test-NetConnection -ComputerName 100.123.51.5 -Port 8000
```

**ì˜ˆìƒ ì¶œë ¥**:
```bash
# í¬íŠ¸ ì‚¬ìš© ì¤‘
$ lsof -i :8000
COMMAND   PID USER   FD   TYPE DEVICE SIZE/OFF NODE NAME
Python  12345 user    3u  IPv4  0t0  TCP *:8000 (LISTEN)

# í¬íŠ¸ ë¹„ì–´ ìˆìŒ
$ lsof -i :8000
(ì¶œë ¥ ì—†ìŒ)
```

---

## 5. í¬íŠ¸ ë³€ê²½ í”„ë¡œí† ì½œ

### ì‹œë‚˜ë¦¬ì˜¤ 1: AíŒ€ì´ ê³µí†µ ì¸í”„ë¼ í¬íŠ¸ ë³€ê²½ (ë“œë¬¼ê²Œ ë°œìƒ)

**ì ˆì°¨**:
1. **ì‚¬ì „ í˜‘ì˜** (ìµœì†Œ 1ì£¼ì¼ ì „)
   - GitHub Issue ìƒì„±: `[ì¸í”„ë¼] MinIO í¬íŠ¸ ë³€ê²½ ê³„íš (9000 â†’ 9010)`
   - BíŒ€, CíŒ€ì— ì•Œë¦¼

2. **ë¬¸ì„œ ì—…ë°ì´íŠ¸**
   - `PORT_ALLOCATION.md` ìˆ˜ì •
   - `FINAL_ENVIRONMENT_STATUS.md` ìˆ˜ì •
   - `.env.example` ì—…ë°ì´íŠ¸

3. **ì½”ë“œ ë³€ê²½**
   - `backend/.env` ìˆ˜ì •
   - `frontend/.env.local` ìˆ˜ì • (í•„ìš” ì‹œ)

4. **ë°°í¬ ë° ê³µì§€**
   - ë³€ê²½ ì‚¬í•­ ì ìš©
   - BíŒ€, CíŒ€ì— ì¬ì‹œì‘ ìš”ì²­

**ì˜ˆì‹œ**:
```bash
# 1. GitHub Issue ìƒì„±
ì œëª©: [AíŒ€] MinIO í¬íŠ¸ ë³€ê²½ (9000 â†’ 9010)
ë‚´ìš©:
- ë³€ê²½ ì¼ì‹œ: 2025-11-20 14:00
- ì´ìœ : í¬íŠ¸ ì¶©ëŒ ë°©ì§€
- ì˜í–¥: BíŒ€ MinIO ì—°ë™ ì½”ë“œ (.env íŒŒì¼ë§Œ ìˆ˜ì •)

# 2. backend/.env ìˆ˜ì •
# ë³€ê²½ ì „
MINIO_ENDPOINT=100.123.51.5:9000

# ë³€ê²½ í›„
MINIO_ENDPOINT=100.123.51.5:9010

# 3. BíŒ€: .env íŒŒì¼ pull í›„ ì¬ì‹œì‘
git pull origin dev
source .venv/bin/activate
uvicorn app.main:app --reload
```

---

### ì‹œë‚˜ë¦¬ì˜¤ 2: BíŒ€ì´ ê°œë°œ í¬íŠ¸ ë³€ê²½

**ì ˆì°¨**:
1. **CíŒ€ì— ì•Œë¦¼** (ì¦‰ì‹œ)
   - Frontendì—ì„œ API URL ìˆ˜ì • í•„ìš”

2. **ë¬¸ì„œ ì—…ë°ì´íŠ¸**
   - `PORT_ALLOCATION.md` ìˆ˜ì •

3. **ì½”ë“œ ë³€ê²½**
   - `frontend/.env.local` ìˆ˜ì •

**ì˜ˆì‹œ**:
```bash
# 1. BíŒ€: í¬íŠ¸ 8000 â†’ 8002ë¡œ ë³€ê²½
# backend/.env
APP_PORT=8002

# 2. CíŒ€ì— Slack/GitHub Issueë¡œ ì•Œë¦¼
"Backend API í¬íŠ¸ê°€ 8000 â†’ 8002ë¡œ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤."

# 3. CíŒ€: frontend/.env.local ìˆ˜ì •
# ë³€ê²½ ì „
NEXT_PUBLIC_API_URL=http://100.123.51.5:8000

# ë³€ê²½ í›„
NEXT_PUBLIC_API_URL=http://100.123.51.5:8002

# 4. CíŒ€: Next.js ì¬ì‹œì‘
npm run dev
```

---

### ì‹œë‚˜ë¦¬ì˜¤ 3: CíŒ€ì´ í”„ë¡ íŠ¸ì—”ë“œ í¬íŠ¸ ë³€ê²½

**ì ˆì°¨**:
1. **ë¬¸ì„œ ì—…ë°ì´íŠ¸** (ì„ íƒ)
   - ê¸°ë³¸ í¬íŠ¸(3000)ê°€ ì•„ë‹Œ ê²½ìš°ë§Œ ë¬¸ì„œí™”

2. **íŒ€ ë‚´ë¶€ ê³µìœ **
   - CíŒ€ ë©¤ë²„ ê°„ ê³µìœ  (ë‹¤ë¥¸ íŒ€ ì˜í–¥ ì—†ìŒ)

**ì˜ˆì‹œ**:
```bash
# Next.js í¬íŠ¸ 3000 â†’ 3005ë¡œ ë³€ê²½
npm run dev -- -p 3005

# ë˜ëŠ” package.json ìˆ˜ì •
{
  "scripts": {
    "dev": "next dev -p 3005"
  }
}
```

---

## 6. ë¬¸ì œ í•´ê²°

### ë¬¸ì œ 1: "Address already in use" ì—ëŸ¬

**ì¦ìƒ**:
```
OSError: [Errno 48] Address already in use
# ë˜ëŠ”
Error: listen EADDRINUSE: address already in use :::8000
```

**ì›ì¸**:
- ì´ì „ì— ì‹œì‘í•œ í”„ë¡œì„¸ìŠ¤ê°€ ì•„ì§ ì¢…ë£Œë˜ì§€ ì•ŠìŒ
- ë‹¤ë¥¸ ì„œë¹„ìŠ¤ê°€ ê°™ì€ í¬íŠ¸ ì‚¬ìš© ì¤‘

**í•´ê²°**:

**Mac mini / Laptop (Unix)**:
```bash
# 1. í¬íŠ¸ ì‚¬ìš© í”„ë¡œì„¸ìŠ¤ í™•ì¸
lsof -i :8000

# ì¶œë ¥ ì˜ˆ:
# COMMAND   PID USER   FD   TYPE DEVICE SIZE/OFF NODE NAME
# Python  12345 user    3u  IPv4  0t0  TCP *:8000 (LISTEN)

# 2. í”„ë¡œì„¸ìŠ¤ ì¢…ë£Œ
kill -9 12345

# 3. ì„œë¹„ìŠ¤ ì¬ì‹œì‘
uvicorn app.main:app --port 8000
```

**Desktop (Windows)**:
```powershell
# 1. í¬íŠ¸ ì‚¬ìš© í”„ë¡œì„¸ìŠ¤ í™•ì¸
netstat -ano | findstr :8000

# ì¶œë ¥ ì˜ˆ:
# TCP    0.0.0.0:8000    0.0.0.0:0    LISTENING    12345

# 2. í”„ë¡œì„¸ìŠ¤ ì¢…ë£Œ
taskkill /PID 12345 /F

# 3. ì„œë¹„ìŠ¤ ì¬ì‹œì‘
python main.py --port 8000
```

---

### ë¬¸ì œ 2: ì›ê²© í¬íŠ¸ ì ‘ê·¼ ë¶ˆê°€

**ì¦ìƒ**:
```bash
# Laptopì—ì„œ Mac mini Backend API í˜¸ì¶œ ì‹¤íŒ¨
curl http://100.123.51.5:8000/health
curl: (7) Failed to connect to 100.123.51.5 port 8000: Connection refused
```

**ì›ì¸**:
1. ì„œë²„ê°€ `localhost` (127.0.0.1)ë§Œ ë¦¬ìŠ¤ë‹
2. ë°©í™”ë²½ ì°¨ë‹¨
3. Tailscale VPN ì—°ê²° ëŠê¹€

**í•´ê²°**:

**1. ì„œë²„ ë¦¬ìŠ¤ë‹ ì£¼ì†Œ í™•ì¸**:
```bash
# Mac miniì—ì„œ í™•ì¸
lsof -i :8000

# ì¶œë ¥:
# Python  12345 user    3u  IPv4  0t0  TCP localhost:8000 (LISTEN)  # âŒ ë¡œì»¬ë§Œ
# Python  12345 user    3u  IPv4  0t0  TCP *:8000 (LISTEN)           # âœ… ëª¨ë“  ì¸í„°í˜ì´ìŠ¤
```

**ìˆ˜ì •**:
```bash
# âŒ ì˜ëª»ëœ ë°©ë²• (ë¡œì»¬ë§Œ ë¦¬ìŠ¤ë‹)
uvicorn app.main:app --host 127.0.0.1 --port 8000

# âœ… ì˜¬ë°”ë¥¸ ë°©ë²• (ëª¨ë“  ì¸í„°í˜ì´ìŠ¤ ë¦¬ìŠ¤ë‹)
uvicorn app.main:app --host 0.0.0.0 --port 8000
```

**2. Tailscale VPN í™•ì¸**:
```bash
# ëª¨ë“  ë…¸ë“œì—ì„œ ì‹¤í–‰
tailscale status

# ì¶œë ¥:
# 100.123.51.5    macmini              user@        macOS   -
# 100.120.180.42  desktop              user@        windows -
# 100.101.68.23   laptop               user@        macOS   -

# ì—°ê²° í…ŒìŠ¤íŠ¸
ping 100.123.51.5
```

**3. ë°©í™”ë²½ í™•ì¸ (Mac mini)**:
```bash
# macOS ë°©í™”ë²½ ìƒíƒœ í™•ì¸
sudo /usr/libexec/ApplicationFirewall/socketfilterfw --getglobalstate

# íŠ¹ì • í¬íŠ¸ í—ˆìš© (í•„ìš” ì‹œ)
# System Settings > Network > Firewallì—ì„œ ìˆ˜ë™ ì„¤ì •
```

---

### ë¬¸ì œ 3: Docker ì»¨í…Œì´ë„ˆ í¬íŠ¸ ë§¤í•‘ ì˜¤ë¥˜

**ì¦ìƒ**:
```bash
# Mac miniì—ì„œ PostgreSQL ì ‘ê·¼ ë¶ˆê°€
psql -h 100.123.51.5 -p 5432 -U sparklio
psql: error: connection to server at "100.123.51.5", port 5432 failed: Connection refused
```

**ì›ì¸**:
- Docker ì»¨í…Œì´ë„ˆ í¬íŠ¸ê°€ Tailscale ì¸í„°í˜ì´ìŠ¤ì— ë°”ì¸ë”©ë˜ì§€ ì•ŠìŒ

**í•´ê²°**:

**1. Docker ì»¨í…Œì´ë„ˆ í¬íŠ¸ í™•ì¸**:
```bash
docker ps

# ì¶œë ¥:
# CONTAINER ID   IMAGE         PORTS
# abc123         postgres:15   0.0.0.0:5432->5432/tcp  # âœ… ëª¨ë“  ì¸í„°í˜ì´ìŠ¤
# abc123         postgres:15   127.0.0.1:5432->5432/tcp  # âŒ ë¡œì»¬ë§Œ
```

**2. docker-compose.yml ìˆ˜ì •**:
```yaml
# âŒ ì˜ëª»ëœ ë°©ë²•
services:
  postgres:
    ports:
      - "127.0.0.1:5432:5432"

# âœ… ì˜¬ë°”ë¥¸ ë°©ë²•
services:
  postgres:
    ports:
      - "5432:5432"  # ë˜ëŠ” "0.0.0.0:5432:5432"
```

**3. ì¬ì‹œì‘**:
```bash
docker compose down
docker compose up -d
```

---

### ë¬¸ì œ 4: í™˜ê²½ ë³€ìˆ˜ í¬íŠ¸ ë¶ˆì¼ì¹˜

**ì¦ìƒ**:
```bash
# BíŒ€: FastAPIëŠ” 8000ë²ˆìœ¼ë¡œ ì‹œì‘í–ˆì§€ë§Œ, CíŒ€ FrontendëŠ” 8001ë¡œ í˜¸ì¶œ
# Frontend ì½˜ì†” ì—ëŸ¬:
# fetch failed: http://100.123.51.5:8001/api/assets
```

**ì›ì¸**:
- Backend `.env`ì™€ Frontend `.env.local` í¬íŠ¸ ë¶ˆì¼ì¹˜

**í•´ê²°**:

**1. Backend í¬íŠ¸ í™•ì¸**:
```bash
# Mac mini
cat ~/sparklio_ai_marketing_studio/backend/.env | grep APP_PORT
# ì¶œë ¥: APP_PORT=8000
```

**2. Frontend í™˜ê²½ ë³€ìˆ˜ í™•ì¸**:
```bash
# Laptop
cat ~/sparklio_ai_marketing_studio/frontend/.env.local | grep NEXT_PUBLIC_API_URL
# ì¶œë ¥: NEXT_PUBLIC_API_URL=http://100.123.51.5:8001  # âŒ í‹€ë¦¼!
```

**3. ìˆ˜ì •**:
```bash
# frontend/.env.local
NEXT_PUBLIC_API_URL=http://100.123.51.5:8000  # âœ… ìˆ˜ì •

# Next.js ì¬ì‹œì‘
npm run dev
```

---

## í¬íŠ¸ í• ë‹¹ ë³€ê²½ ì´ë ¥

| ë‚ ì§œ | ë³€ê²½ ë‚´ìš© | ë³€ê²½ì | ì˜í–¥ ë²”ìœ„ |
|------|----------|--------|----------|
| 2025-11-15 | ì´ˆê¸° í¬íŠ¸ í• ë‹¹ í™•ì • | AíŒ€ | ì „ì²´ |

---

## ì¶”ê°€ ë¦¬ì†ŒìŠ¤

### ê´€ë ¨ ë¬¸ì„œ

- **ê°œë°œ ì›Œí¬í”Œë¡œìš°**: [DEV_WORKFLOW.md](./DEV_WORKFLOW.md)
- **í™˜ê²½ ìƒíƒœ**: [FINAL_ENVIRONMENT_STATUS.md](./FINAL_ENVIRONMENT_STATUS.md)
- **Backend ê°€ì´ë“œ**: [handoff/BACKEND_IMPLEMENTATION_GUIDE.md](./handoff/BACKEND_IMPLEMENTATION_GUIDE.md)

### ìœ ìš©í•œ ëª…ë ¹ì–´

**í¬íŠ¸ ì‚¬ìš© í™•ì¸ (ëª¨ë“  íŒ€)**:
```bash
# Unix (Mac mini, Laptop)
lsof -i -P -n | grep LISTEN

# Windows (Desktop)
netstat -ano | findstr LISTENING
```

**Tailscale ë„¤íŠ¸ì›Œí¬ ìƒíƒœ**:
```bash
tailscale status
tailscale ping 100.123.51.5
```

**Docker í¬íŠ¸ ë§¤í•‘ í™•ì¸**:
```bash
docker ps --format "table {{.Names}}\t{{.Ports}}"
```

---

## í¬íŠ¸ í• ë‹¹ ìš”ì²­ ì–‘ì‹

ìƒˆë¡œìš´ í¬íŠ¸ê°€ í•„ìš”í•œ ê²½ìš° GitHub Issueë¥¼ ìƒì„±í•´ì£¼ì„¸ìš”:

**ì œëª©**: `[í¬íŠ¸ í• ë‹¹] {ì„œë¹„ìŠ¤ëª…} - {ìš”ì²­ íŒ€}`

**ë³¸ë¬¸**:
```markdown
## ìš”ì²­ ì •ë³´
- **íŒ€**: BíŒ€
- **ì„œë¹„ìŠ¤ëª…**: Celery Worker
- **í¬ë§ í¬íŠ¸**: 5555
- **ìš©ë„**: ë¹„ë™ê¸° ì‘ì—… ëª¨ë‹ˆí„°ë§ (Flower UI)
- **ë…¸ë“œ**: Mac mini (100.123.51.5)

## ì ‘ê·¼ ë²”ìœ„
- [ ] ê³µê°œ (ëª¨ë“  ë…¸ë“œ)
- [x] Backend ì „ìš©
- [ ] ê°œë°œìë§Œ (ë¸Œë¼ìš°ì €)

## ìš°ì„ ìˆœìœ„
- [x] High (ì¦‰ì‹œ í•„ìš”)
- [ ] Medium (1ì£¼ì¼ ì´ë‚´)
- [ ] Low (í–¥í›„ ê³ ë ¤)

## ì¶©ëŒ í™•ì¸
- [x] í¬íŠ¸ í• ë‹¹í‘œ í™•ì¸ ì™„ë£Œ
- [x] `lsof -i :5555` ì‹¤í–‰ (ì‚¬ìš© ì¤‘ ì•„ë‹˜)
```

---

**ì‘ì„±ì¼**: 2025-11-15
**ì‘ì„±ì**: A Team Leader
**ë²„ì „**: 1.0
**ìŠ¹ì¸ì**: (ì „ì²´ íŒ€ ë¦¬ë·° í•„ìš”)
